<div fxLayout="column" class="container">
  <div *ngFor="let org of (orgs$ | async)" fxLayout="row wrap" fxLayoutAlign="start space-between" fxLayoutGap="50px">
    <h1 fxFlex="100" class="mat-h1">{{ org.name }}</h1>
    <!-- ADD A NEW MOVIE BUTTON -->
    <mat-card class="movie-card">
      <mat-card-content fxFlex="100" fxFlexAlign="center" class="center">
          <button color="primary" mat-icon-button matRipple (click)="addNewMovie(org.id, org.name)">
            <mat-icon style="font-size: 40px; margin-left: -20px;">add_circle_outline</mat-icon>
          </button>
          <h3 class="mat-h3">ADD A MOVIE</h3>
      </mat-card-content>
    </mat-card>
    <ng-container *ngFor="let movie of (movies$ | async)" >
      <div *ngIf="movie.id" class="movie-card">
        <!-- MOVIE CARDS -->
        <mat-card *ngIf="org.id === movie.organization.id">
          <div class="img-container">
            <img *ngIf="movie.poster; else defaultPoster" mat-card-image src={{movie.poster}} />
            <ng-template #defaultPoster><img src="defaultPoster"></ng-template>
            <button mat-icon-button [matMenuTriggerFor]="menu">
              <mat-icon color="primary">more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu" xPosition="before">
              <button mat-menu-item [matMenuTriggerFor]="subMenu">
                <mat-icon color="primary">control_camera</mat-icon>
                <span>Open in...</span>
              </button>
              <button mat-menu-item [routerLink]="['form', movie.id]">
                <mat-icon color="primary">edit</mat-icon>
                <span>Edit</span>
              </button>
              <button mat-menu-item (click)="delete(movie.id)">
                <mat-icon color="primary">delete_outline</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>

            <mat-menu #subMenu="matMenu">
              <button mat-menu-item [routerLink]="['/layout', movie.id]">Current app</button>
            </mat-menu>
          </div>

          <mat-card-header>
            <mat-card-title *ngIf="movie.title">
              {{ movie.title.original }}
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <p>
              {{ movie.logline }}
            </p>
          </mat-card-content>
          <mat-card-actions>
            <button color="primary" mat-button [routerLink]="['movie', movie.id]">ACCESS</button>
          </mat-card-actions>
        </mat-card>
      </div>
    </ng-container>
  </div>
</div>
